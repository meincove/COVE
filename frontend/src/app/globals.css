/* =========================
   globals.css (clean)
   ========================= */

/* Fonts */
@font-face {
  font-family: "Sansilk";
  src: url("/fonts/Sansilk.ttf") format("truetype");
  font-weight: 700;
  font-style: italic;
}

/* Resets & guards */
*,
*::before,
*::after { box-sizing: border-box; }

html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;               
}

html { overflow-x: clip; }         /* no accidental horizontal scrollbars */

/* Tailwind */
@import "tailwindcss";
@import "tw-animate-css";

/* shadcn dark helper */
@custom-variant dark (&:is(.dark *));

/* Theme vars */
@layer base {
  * { @apply border-border outline-ring/50; }
  body { @apply bg-background text-foreground; }
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
  --color-ring: var(--ring);
  --color-input: var(--input);
  --color-border: var(--border);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
}

:root {
  --radius: 0rem;

  /* === Overlay sizing knobs (NEW) === */
  /* You fully control overlay “page card” size with these */
  --ov-top-offset: 122px;                 /* space from top screen to card */
  --ov-w: min(100vw, 1400px);             /* card width (try 100vw, 1280px, etc.) */
  --ov-h: 10dvh;                         /* card height (try 100dvh, 120dvh) */
  --ov-radius: 6px;

  /* light theme */
  --background: oklch(1 0 0);
  --foreground: oklch(0.141 0.005 285.823);
  --ring: oklch(0.705 0.015 286.067);
  --border: oklch(0.92 0.004 286.32);
  --input: oklch(0.92 0.004 286.32);

  /* === Frame sizing knobs (existing) === */
  --frame-scale: 1;

  /* Per-side rims (pixel-perfect per side) */
  --gap-top: 72px;
  --gap-right: 16px;
  --gap-bottom: 24px;
  --gap-left: 16px;

  /* Old overlay band height (kept for compatibility but not used) */
  --band-top-height: var(--gap-top);

  /* Overlay top bar spacing/sizing (legacy; safe to keep) */
  --overlay-top-pad: 12px;
  --overlay-top-bar-height: 56px;
  --overlay-top-hpad: 16px;
  --overlay-top-gap: 12px;
  --overlay-top-max-w: 1400px;
}

.dark {
  --background: oklch(0.141 0.005 285.823);
  --foreground: oklch(0.985 0 0);
  --ring: oklch(0.552 0.016 285.938);
  --border: oklch(1 0 0 / 10%);
  --input: oklch(1 0 0 / 15%);
}

/* Helpers */
.text-white { text-shadow: 0 1px 2px rgba(0,0,0,.5); }
.perspective { perspective: 1200px; }
@layer utilities { .animate-spin-slow { animation: spin 20s linear infinite; } }

/* === The single global scroll frame === */
.tester-frame {
  position: relative;
  z-index: 200;                    /* above overlay backdrop (120) and below overlay card (180+) */
  height: 100dvh;
  width: 100%;
  overflow-y: auto;
  overflow-x: clip;
  background: var(--background);
  transition:
    margin .28s ease,
    width .28s ease,
    height .28s ease,
    border-radius .28s ease,
    box-shadow .28s ease;
  scrollbar-gutter: stable both-edges;
  will-change: margin, width, height;
}

/* Optional: hide scrollbar UI, keep scroll */
.tester-frame::-webkit-scrollbar { display: none; }
.tester-frame { scrollbar-width: none; }

/* === Menu open: per-side shrink (no scale) === */
html.menu-open .tester-frame {
  margin: var(--gap-top) var(--gap-right) var(--gap-bottom) var(--gap-left);
  width:  calc(100vw  - var(--gap-left) - var(--gap-right));
  height: calc(100dvh - var(--gap-top)  - var(--gap-bottom));
  border-radius: 24px;
  clip-path: inset(0 round 24px);
  box-shadow:
    0 40px 120px -24px rgba(0,0,0,.55),
    inset 0 0 0 1px rgba(255,255,255,.08);
}

/* Navbar sits inside the frame so it moves with it */
.nav-stick { position: sticky; top: 0; height: 0; z-index: 210; pointer-events: auto; }

/* Navbar shell cosmetics (demo) */
.nav-shell {
  @apply rounded-2xl md:rounded-3xl border;
  background: rgba(255, 255, 255, 0.96);
  color: #0b0b0b;
  border-color: rgba(0,0,0,.08);
  box-shadow: 0 18px 40px rgba(0,0,0,.25);
  backdrop-filter: blur(12px);
}

/* Body surface holding page sections (demo) */
.content-surface { background: #9ca3af; min-height: 100%; }

/* Demo sections */
.demo-section {
  background: #ffffff;
  color: #111827;
  border-radius: 1rem;
  box-shadow: 0 10px 30px rgba(0,0,0,.15);
}

/* ===== NEW OVERLAY LAYOUT (independently sized card) ===== */

/* Root covers screen and creates a top spacer + a stage area */
.overlay-root{
  position: fixed;
  inset: 0;
  z-index: 180;
  pointer-events: none;                 /* becomes auto when menu-open */
  display: grid;
  grid-template-rows: var(--ov-top-offset) 1fr;
}

/* The stage centers the card horizontally */
.overlay-stage{
  display: grid;
  place-items: start center;            /* start vertically, center horizontally */
  overflow: visible;
}

/* The actual overlay “page card” you control */
.overlay-card{
  width: var(--ov-w);
  height: var(--ov-h);
  border-radius: var(--ov-radius);
  background: #ffffff;
  box-shadow: 0 18px 40px rgba(0,0,0,.18);
  overflow: hidden;                     /* keep children inside rounded corners */
  pointer-events: auto;
  display: grid;
  grid-template-columns: 1fr 1.3fr 1fr; /* Left | Center | Right */
  gap: 12px;
  padding: 10px 12px;
}

/* Mobile stacking */
@media (max-width: 768px){
  .overlay-card{
    grid-template-columns: 1fr;
    grid-auto-rows: min-content;
    height: min(92dvh, var(--ov-h));
  }
}

/* Slots inside the card */
.overlay-slot-left,
.overlay-slot-center,
.overlay-slot-right{
  display: flex;
  align-items: center;
  gap: 10px;
  min-width: 0;
  overflow: hidden;
  padding: 6px 8px;
}

/* Center (search) stretches */
.overlay-slot-center > * { width: 100%; min-width: 0; }

/* When the overlay is active (menu-open), allow clicks on root (otherwise it’s pass-through) */
html.menu-open .overlay-root{ pointer-events: auto; }

/* Make inline text/icons in card dark */
.overlay-card { color: #0b0b0b; }
.overlay-card :where(a,button,span,svg){ color:#0b0b0b !important; fill: currentColor; }

/* === Dev overlay-only mode (optional) === */
html.overlay-dev .tester-frame { display: none !important; }
html.overlay-dev .nav-stick   { display: none !important; }
html.overlay-dev .overlay-root{ pointer-events: auto; } /* always clickable in dev */

/* ===== NAV: full (space-taking) vs island (floating) ===== */

/* Full navbar wrapper TAKES space */
.nav-full-wrap {
  position: sticky;
  top: 0;
  z-index: 210;
  background: transparent;
}

/* Full shell (wide bar) */
.nav-full-shell {
  height: 72px;
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: 12px;

  width: min(calc(100% - 24px), 1200px);
  margin: 8px auto;
  padding: 10px 12px;

  border-radius: 16px;
  background: rgba(255,255,255,.96);
  border: 1px solid rgba(0,0,0,.08);
  box-shadow: 0 18px 40px rgba(0,0,0,.25);
  backdrop-filter: blur(12px);

  color: #0b0b0b;
  transition: transform .28s ease, opacity .28s ease;
}

/* Island wrapper: sticky but ZERO height */
.nav-island-wrap {
  position: sticky;
  top: 0;
  height: 0;
  z-index: 211;
  pointer-events: none;
}

/* Island shell (floating compact bar) */
.nav-island-shell {
  position: absolute;
  top: 8px;
  left: 50%;
  transform: translate(-50%, -16px);
  opacity: 0;
  pointer-events: auto;

  height: 64px;
  width: clamp(360px, 60vw, 680px);

  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: 12px;

  padding: 8px 12px;
  border-radius: 16px;
  background: rgba(255,255,255,.96);
  border: 1px solid rgba(0,0,0,.08);
  box-shadow: 0 18px 40px rgba(0,0,0,.25);
  backdrop-filter: blur(12px);

  color: #0b0b0b;
  transition: transform .28s ease, opacity .28s ease;
}

/* Slot helpers */
.nav-left, .nav-right { display:flex; align-items:center; gap:10px; min-width:0; }
.nav-center { display:flex; align-items:center; min-width:0; }
.nav-center > * { width: 100%; }

/* Make nested buttons/links/icons dark */
.nav-full-shell :where(a,button,span,svg),
.nav-island-shell :where(a,button,span,svg){
  color:#0b0b0b !important;
  fill: currentColor;
}

/* ====== Animated states toggled by data-attrs ====== */

[data-collapse-full="true"] .nav-full-shell {
  transform: translateY(-110%);
  opacity: 0;
  pointer-events: none;
}

[data-show-island="true"] .nav-island-shell {
  transform: translate(-50%, 0);
  opacity: 1;
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  .nav-full-shell, .nav-island-shell { transition: none; }
}

/* Floating island pill */
.floating-nav{
  position: fixed;
  top: 14px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 260;
  pointer-events: auto;
}

/* Anchor lives inside .tester-frame */
.island-anchor{
  position: sticky; top: 0; height: 0;
  z-index: 210; pointer-events: none;
}

/* The pill itself */
.island-pill{
  position: absolute; top: 14px; left: 50%;
  transform: translateX(-50%);
  pointer-events: auto; z-index: 260;
}

/* When search is shown, make the pill wide but not full-bleed */
.island-pill.withSearch{ width: min(92vw, 1000px); }

/* let dropdowns spill out of the bar */
.overlay-card { overflow: visible; }   /* (replaces legacy .overlay-top-inner overflow rule) */


/* ——— Overlay hard overrides ——— */

/* Kill any legacy max-width/clamps that might still exist */
.overlay-card {
  max-width: none !important;
  width: var(--ov-w) !important;   /* trust the variable */
  margin: 0;                       /* no implicit centering margins */
}

/* Make sure parents don't introduce side gutters */
.overlay-root,
.overlay-stage {
  padding: 0 !important;
  margin: 0 !important;
  width: 100vw;                    /* parent can’t be narrower than the viewport */
}

/* Optional: a “full-bleed” mode you can toggle */
[data-fullbleed="true"] .overlay-card {
  width: 100vw !important;
  border-radius: 0;                /* edge-to-edge look */
  box-shadow: none;                /* usually looks better when full-bleed */
}


/* make the overlay card equal thirds on md+; single column on mobile as you had */
.overlay-card.overlay-card--thirds {
  display: grid;
  grid-template-columns: 1fr;            /* mobile */
  gap: 12px;
}
@media (min-width: 768px) {
  .overlay-card.overlay-card--thirds {
    grid-template-columns: 1fr 1fr 1fr;  /* equal thirds */
  }
}

/* containment and padding for all three slots */
.overlay-slot-left,
.overlay-slot-center,
.overlay-slot-right {
  min-width: 0;          /* allow children to shrink inside grid */
  overflow: hidden;      /* no leaking */
  padding: 6px 8px;      /* comfy */
  display: flex;
  align-items: center;
  gap: 10px;
}

/* parent card look (keep white-ish background as requested) */
.overlay-card {
  background: #ffffff;
  border-radius: 16px;
  box-shadow: 0 18px 40px rgba(0,0,0,.18);
}


/* The overlay root already fades; we align the card width to the revealed page area */
.overlay-stage {
  padding:
    var(--overlay-top-pad)
    calc(var(--gap-right) + var(--overlay-top-hpad))
    0
    calc(var(--gap-left)  + var(--overlay-top-hpad));
}

.overlay-card {
  /* match visible page area; cap at the same max width */
  max-width: min(
    var(--overlay-top-max-w),
    calc(100vw - var(--gap-left) - var(--gap-right) - 2*var(--overlay-top-hpad))
  );
  margin: 0 auto;
}

/* Equal thirds (md+) and containment; allow 3D lift to breathe */
.overlay-card.overlay-card--thirds {
  display: grid;
  grid-template-columns: 1fr;
  gap: 12px;
}
@media (min-width: 768px) {
  .overlay-card.overlay-card--thirds { grid-template-columns: 1fr 1fr 1fr; }
}

/* Slots */
.overlay-slot-left,
.overlay-slot-center,
.overlay-slot-right {
  min-width: 0;
  padding: 6px 8px;
  display: flex;
  align-items: center;
  gap: 10px;
  /* Let the 3D hover peek a couple of px so it doesn’t look “cut off”.
     If you want strict containment, keep overflow:hidden and reduce rotateX/Y above. */
  overflow: visible;
}
